significance = case_when(
p_value < 0.001 ~ "***",
p_value < 0.01 ~ "**",
p_value < 0.05 ~ "*",
TRUE ~ "ns"  # Not significant
) )
# Print the resulting pairwise_diff data frame
print(pairwise_diff)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "blue") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "red", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_minimal()
# Display the plot
print(interval_plot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "red", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_minimal()
# Display the plot
print(interval_plot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "midnightblue", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_minimal()
# Display the plot
print(interval_plot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "seagreen2", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_minimal()
# Display the plot
print(interval_plot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "navyblue", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_minimal()
# Display the plot
print(interval_plot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "navyblue", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_bw()
# Display the plot
print(interval_plot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "orangered", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_bw()
# Display the plot
print(interval_plot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "darkgreen", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_bw()
# Display the plot
print(interval_plot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "hotpink") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "navyblue", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_bw()
# Display the plot
print(interval_plot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "lightpink") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "navyblue", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_bw()
# Display the plot
print(interval_plot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "navyblue", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_bw()
# Display the plot
print(interval_plot)
agg_png("figures/interval_plot.png",
width = 40, height = 40, units = "cm", res = 300, scaling = 2)
print(culmen_scatterplot)
dev.off()
agg_png("figures/interval_plot2.png",
width = 20, height = 20, units = "cm", res = 300, scaling = 1)
print(culmen_scatterplot)
dev.off()
inches_conversion = 2.54
svglite("figures/interval_plot.svg",
width = 40 / inches_conversion,
height = 40 / inches_conversion,
scaling = 2)
print(culmen_scatterplot)
dev.off()
agg_png("figures/interval_plot.png",
width = 40, height = 40, units = "cm", res = 300, scaling = 2)
print(interval_plot)
dev.off()
agg_png("figures/interval_plot2.png",
width = 20, height = 20, units = "cm", res = 300, scaling = 1)
print(interval_plot)
dev.off()
inches_conversion = 2.54
svglite("figures/interval_plot.svg",
width = 40 / inches_conversion,
height = 40 / inches_conversion,
scaling = 2)
print(interval_plot)
dev.off()
agg_png("figures/interval_plot.png",
width = 20, height = 20, units = "cm", res = 300, scaling = 1)
print(interval_plot)
dev.off()
# Define color mapping with names for each species
species_colours <- c(
"Adelie" = "darkorange",
"Chinstrap" = "purple",
"Gentoo" = "cyan4")
# Scatterplot of bill dimensions by species with custom colors
culmen_scatterplot <- ggplot(penguins_data_for_scatterplot, aes(x = culmen_length_mm, y = culmen_depth_mm, color = species)) +
geom_point(alpha = 0.7, size = 3) +
scale_color_manual(values = species_colours) +  # Apply custom colors
labs(
title = "Bill Dimensions by Penguin Species",
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
color = "Species"
) +
theme_minimal()
# Display the plot
print(culmen_scatterplot)
# Extracting the Tukey HSD results into a dataframe:
tukey_df <- as.data.frame(tukey_result$species)
# Add a column for the species comparisons (rownames)
tukey_df$Comparison <- rownames(tukey_df)
# Create the pairwise_diff data frame
pairwise_diff <- tukey_df %>%
select(Comparison, diff, lwr, upr, `p adj`) %>%
rename(
Difference = diff,
Lower = lwr,
Upper = upr,
p_value = `p adj`
)  %>%
mutate(
significance = case_when(
p_value < 0.001 ~ "***",
p_value < 0.01 ~ "**",
p_value < 0.05 ~ "*",
TRUE ~ "ns"  # Not significant
) )
# Print the resulting pairwise_diff data frame
print(pairwise_diff)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "navyblue", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Position asterisks above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_bw()
# Display the plot
print(interval_plot)
# Define color mapping with names for each species
species_colours <- c(
"Adelie" = "darkorange",
"Chinstrap" = "purple",
"Gentoo" = "cyan4")
# Scatterplot of bill dimensions by species with custom colors
culmen_scatterplot <- ggplot(penguins_data_for_scatterplot, aes(x = culmen_length_mm, y = culmen_depth_mm, color = species)) +
geom_point(alpha = 0.7, size = 3) +
scale_color_manual(values = species_colours) +  # Apply custom colors
labs(
title = "Bill Dimensions by Penguin Species",
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
color = "Species"
) +
theme_minimal()
# Display the plot
print(culmen_scatterplot)
# One-way ANOVA
summary(anova_result)
print(tukey_result)
# One-way ANOVA
summary(anova_result)
print(tukey_result)
# Extracting the Tukey HSD results into a dataframe:
tukey_df <- as.data.frame(tukey_result$species)
# Adding a column for the species comparisons (rownames)
tukey_df$Comparison <- rownames(tukey_df)
# Creating the pairwise_diff data frame with significance levels indicated
pairwise_diff <- tukey_df %>%
select(Comparison, diff, lwr, upr, `p adj`) %>%
rename(
Difference = diff,
Lower = lwr,
Upper = upr,
p_value = `p adj`
)  %>%
mutate(
significance = case_when(
p_value < 0.001 ~ "***",
p_value < 0.01 ~ "**",
p_value < 0.05 ~ "*",
TRUE ~ "ns"  # Not significant
) )
# Print the resulting pairwise_diff data frame
print(pairwise_diff)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") +  # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "navyblue", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Positioning significance levels above the error bars
size = 5,
color = "black"
) +
labs(
title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)"
) +
theme_bw()
# Display the plot
print(interval_plot)
# Define color mapping with names for each species
species_colours <- c(
"Adelie" = "darkorange",
"Chinstrap" = "purple",
"Gentoo" = "cyan4")
# Scatterplot of bill dimensions by species with custom colors
bill_scatterplot <- ggplot(penguins_data_for_scatterplot, aes(x = culmen_length_mm, y = culmen_depth_mm, color = species)) +
geom_point(alpha = 0.7, size = 3) +
scale_color_manual(values = species_colours) +
labs(
title = "Bill Dimensions by Penguin Species",
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
color = "Species"
) +
theme_minimal()
# Display the plot
print(bill_scatterplot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") + # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "navyblue", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Positioning significance levels above the error bars
size = 5,
color = "black"
) +
labs(title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)") +
theme_bw()
# Display the plot
print(interval_plot)
print(pairwise_diff)
# Subseting the columns body mass and flipper length, removing NAs
penguins_data_for_plotting <- penguins_clean %>%
select(body_mass_g, flipper_length_mm, species) %>%
na.omit(body_mass_g, flipper_length_mm)
# Poor visualization of data using a scatterplot of body mass (g) and flipper length (mm):
penguins_bodymass_flippers <-ggplot(penguins_data_for_plotting, aes(x = body_mass_g, y = flipper_length_mm, color = species)) +
geom_point(size = 5, alpha = 1) +  # Big, opaque points
theme_minimal() +
labs(
x = "Body Mass (g)",
y = "Flipper Length (mm)"
) +
theme(
legend.position = "none"  # No legend
)
penguins_bodymass_flippers
# Define color mapping with names for each species
species_colours <- c(
"Adelie" = "darkorange",
"Chinstrap" = "purple",
"Gentoo" = "cyan4")
# Scatterplot of bill dimensions by species with custom colors
bill_scatterplot <- ggplot(penguins_data_for_scatterplot, aes(x = culmen_length_mm, y = culmen_depth_mm, color = species)) +
geom_point(alpha = 0.7, size = 3) +
scale_color_manual(values = species_colours) +
labs(
title = "Bill Dimensions by Penguin Species",
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
color = "Species"
) +
theme_minimal()
# Display the plot
print(bill_scatterplot)
# Saving as .png
agg_png("figures/culmen_scatterplot.png",
width = 40, height = 40, units = "cm", res = 300, scaling = 2)
print(culmen_scatterplot)
dev.off()
# Saving as .svg
inches_conversion = 2.54
svglite("figures/culmen_scatterplot.svg",
width = 40 / inches_conversion,
height = 40 / inches_conversion,
scaling = 2)
print(culmen_scatterplot)
dev.off()
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") + # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "navyblue", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Positioning significance levels above the error bars
size = 5,
color = "black"
) +
labs(title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)") +
theme_bw()
# Display the plot
print(interval_plot)
# Interval plot with significance annotations
interval_plot <- ggplot(pairwise_diff, aes(x = Comparison, y = Difference)) +
geom_point(size = 4, color = "maroon2") +  # Mean differences as points
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "black") + # Vertical error bars
geom_hline(yintercept = 0, linetype = "dashed", color = "navyblue", size = 0.8) +  # Zero difference reference line
geom_text(
aes(label = significance, y = Upper + 0.5),  # Positioning significance levels above the error bars
size = 5,
color = "black"
) +
labs(title = "Pairwise Differences in Bill Length Between Penguin Species",
x = "Species Comparison",
y = "Difference in Mean Bill Length (mm)") +
theme_bw()
# Display the plot
print(interval_plot)
library(tinytex)
library(tinytex)
# Saving as .png
agg_png("figures/bill_scatterplot.png",
width = 40, height = 40, units = "cm", res = 300, scaling = 2)
print(bill_scatterplot)
dev.off()
# Saving as .svg
inches_conversion = 2.54
svglite("figures/bill_scatterplot.svg",
width = 40 / inches_conversion,
height = 40 / inches_conversion,
scaling = 2)
print(bill_scatterplot)
dev.off()
tinytex::install_tinytex()
install.packages("tinytex")
library(tinytex)
library(tinytex)
detach("package:tinytex", unload = TRUE)
library(tinytex)
library(tidyverse)
library(palmerpenguins)
library(here)
library(janitor)
library(ggplot2)
library(ragg)
library(svglite)
library(tinytex)
library(tidyverse)
library(palmerpenguins)
library(here)
library(janitor)
library(ggplot2)
library(ragg)
library(svglite)
